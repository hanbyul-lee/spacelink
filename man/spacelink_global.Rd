% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spacelink_global.R
\name{spacelink_global}
\alias{spacelink_global}
\title{Global Spatial Variability Analysis}
\usage{
spacelink_global(
  Y,
  spatial_coords,
  X = NULL,
  lengthscales = NULL,
  n_lengthscales = 5,
  M = 1,
  n_workers = 1
)
}
\arguments{
\item{Y}{Normalized count matrix. Rows and columns indicate genes and spots, respectively.}

\item{spatial_coords}{Spatial coordinates matrix. Rows indicate spots.}

\item{X}{Spatial features expected to include intercept. If NULL, X = rep(1,N) where N is number of spots.}

\item{lengthscales}{If NULL, length-scales are calculated using the two-step approach.}

\item{n_lengthscales}{Number of length-scales (i.e., number of kernels). Default is 5.}

\item{M}{Controls the minimum length-scale. Minimum length-scale is set to be the minimum distance multiplied by M. Default is 1.}

\item{n_workers}{Number of workers for parallelization. Default is 1.}
}
\value{
A data frame containing:
\describe{
\item{tau.sq}{Nugget variance component}
\item{sigma.sq1, sigma.sq2, ...}{Spatial variance components for each kernel}
\item{ESV}{Effective Spatial Variability score}
\item{pval}{Combined p-value from score tests}
\item{padj}{Benjamini-Hochberg adjusted p-values}
\item{ESV_adj}{ESV adjusted for multiple testing (0 if padj > 0.05)}
}
}
\description{
Performs global spatial gene variability analysis across multiple length scales
using kernel-based methods.
}
\examples{
\dontrun{
# Example with simulated data
set.seed(123)
n_spots <- 100
n_genes <- 50

# Generate spatial coordinates
coords <- matrix(runif(n_spots * 2), ncol = 2)

# Generate expression data
expr_data <- matrix(rnorm(n_genes * n_spots), nrow = n_genes)

# Run global analysis
results <- spacelink_global(
  Y = expr_data,
  spatial_coords = coords,
  n_lengthscales = 5
)

# View top spatially variable genes
head(results[order(results$pval), ])
}

}
