% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spacelink_cell_type.R
\name{spacelink_cell_type}
\alias{spacelink_cell_type}
\title{Cell Type-Specific Spatial Variability Analysis}
\usage{
spacelink_cell_type(
  global_test_res,
  ct_idx,
  Y,
  spatial_coords,
  cell_type_data,
  c1 = 0.25,
  c2 = 0.2,
  is_phi_reduce = TRUE,
  n_workers = 1
)
}
\arguments{
\item{global_test_res}{Spacelink global SVG test results from \code{\link{spacelink_global}}.}

\item{ct_idx}{Index of cell-type to be tested.}

\item{Y}{Normalized count matrix. Rows and columns indicate genes and spots, respectively.}

\item{spatial_coords}{Spatial coordinates matrix. Rows indicate spots.}

\item{cell_type_data}{Cell-type data matrix. Cell-type proportions (e.g., RCTD) or cell-type abundance (e.g., Cell2location).}

\item{c1}{Gating parameter 1. Default is 0.25.}

\item{c2}{Gating parameter 2. Default is 0.2.}

\item{is_phi_reduce}{If TRUE, kernel bandwidths are restricted to be smaller than the maximum distance among cells within target cell type. Default is TRUE.}

\item{n_workers}{Number of workers for parallelization. Default is 1.}
}
\value{
A data frame containing:
\describe{
\item{time}{Computation time}
\item{pval}{Combined p-value for cell type-specific spatial patterns}
}
}
\description{
Performs cell type-specific spatial gene variability analysis using results
from global analysis.
}
\examples{
\dontrun{
# First run global analysis
global_results <- spacelink_global(Y, spatial_coords)

# Then cell type-specific analysis
ct_results <- spacelink_cell_type(
  global_test_res = global_results,
  ct_idx = 1,  # first cell type
  Y = Y,
  spatial_coords = spatial_coords,
  cell_type_data = cell_proportions
)
}

}
