<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with spacelink • spacelink</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with spacelink">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spacelink</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/multiscale-analysis.html">Multi-scale Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/cell-type-analysis.html">Cell Type-Specific Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/xueweic/spacelink" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with spacelink</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/xueweic/spacelink/blob/main/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>spacelink</code> package provides statistical methods for
analyzing spatial gene expression patterns across multiple scales. It
helps identify genes with significant spatial variability and understand
how this variability manifests at different length scales.</p>
<div class="section level3">
<h3 id="key-concepts">Key Concepts<a class="anchor" aria-label="anchor" href="#key-concepts"></a>
</h3>
<p><strong>Spatial Gene Variability (SGV)</strong>: Measures how gene
expression varies across spatial locations in tissue samples.</p>
<p><strong>Multi-scale Analysis</strong>: Examines spatial patterns at
different length scales, from local neighborhoods to global tissue-wide
patterns.</p>
<p><strong>Effective Spatial Variability (ESV)</strong>: A summary score
between 0 and 1 that quantifies the overall spatial variability of a
gene, with higher values indicating stronger spatial patterns.</p>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>Install the development version from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"xueweic/spacelink"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xueweic.github.io/spacelink/">spacelink</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="basic-workflow">Basic Workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h3>
<p>The typical analysis workflow involves three main steps:</p>
<div class="section level4">
<h4 id="global-spatial-analysis">1. Global Spatial Analysis<a class="anchor" aria-label="anchor" href="#global-spatial-analysis"></a>
</h4>
<p>Start with global analysis to identify spatially variable genes:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run global spatial variability analysis</span></span>
<span><span class="va">global_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spacelink_global.html">spacelink_global</a></span><span class="op">(</span></span>
<span>  Y <span class="op">=</span> <span class="va">expression_matrix</span>,          <span class="co"># Genes × Spots</span></span>
<span>  spatial_coords <span class="op">=</span> <span class="va">coordinates</span>,   <span class="co"># Spots × 2 (x,y coordinates)</span></span>
<span>  n_lengthscales <span class="op">=</span> <span class="fl">5</span>             <span class="co"># Number of spatial scales</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">global_results</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">global_results</span><span class="op">$</span><span class="va">pval</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The results include: - <strong>ESV</strong>: Effective Spatial
Variability score (0-1) - <strong>pval</strong>: Combined p-value for
spatial significance - <strong>padj</strong>: Benjamini-Hochberg
adjusted p-values - <strong>tau.sq, sigma.sq1, …</strong>: Variance
components at different scales</p>
</div>
<div class="section level4">
<h4 id="cell-type-specific-analysis-optional">2. Cell Type-Specific Analysis (Optional)<a class="anchor" aria-label="anchor" href="#cell-type-specific-analysis-optional"></a>
</h4>
<p>If you have cell type data, analyze cell type-specific spatial
patterns:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cell type-specific analysis</span></span>
<span><span class="va">ct_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spacelink_cell_type.html">spacelink_cell_type</a></span><span class="op">(</span></span>
<span>  global_test_res <span class="op">=</span> <span class="va">global_results</span>,</span>
<span>  ct_idx <span class="op">=</span> <span class="fl">1</span>,                    <span class="co"># Cell type index to test</span></span>
<span>  Y <span class="op">=</span> <span class="va">expression_matrix</span>,</span>
<span>  spatial_coords <span class="op">=</span> <span class="va">coordinates</span>,</span>
<span>  cell_type_data <span class="op">=</span> <span class="va">cell_proportions</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="calculate-cell-type-esv-optional">3. Calculate Cell Type ESV (Optional)<a class="anchor" aria-label="anchor" href="#calculate-cell-type-esv-optional"></a>
</h4>
<p>Calculate ESV scores specific to individual cell types:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cell type-specific ESV</span></span>
<span><span class="va">esv_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spacelink_cell_type_ESV.html">spacelink_cell_type_ESV</a></span><span class="op">(</span></span>
<span>  global_test_res <span class="op">=</span> <span class="va">global_results</span>,</span>
<span>  ct_idx <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Y <span class="op">=</span> <span class="va">expression_matrix</span>,</span>
<span>  spatial_coords <span class="op">=</span> <span class="va">coordinates</span>,</span>
<span>  cell_type_data <span class="op">=</span> <span class="va">cell_proportions</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="example-with-simulated-data">Example with Simulated Data<a class="anchor" aria-label="anchor" href="#example-with-simulated-data"></a>
</h3>
<p>Here’s a complete example using simulated data:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up simulated data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_spots</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">n_genes</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># Generate spatial coordinates (2D grid)</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n_spots</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n_spots</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate expression data with spatial patterns</span></span>
<span><span class="va">expr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_genes</span> <span class="op">*</span> <span class="va">n_spots</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_genes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">expr_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Gene_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_genes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add spatial pattern to some genes</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Create distance-based pattern</span></span>
<span>  <span class="va">center_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>  <span class="va">center_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">x</span> <span class="op">-</span> <span class="va">center_x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">center_y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">spatial_effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">distances</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">expr_data</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">expr_data</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">spatial_effect</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run analysis</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spacelink_global.html">spacelink_global</a></span><span class="op">(</span></span>
<span>  Y <span class="op">=</span> <span class="va">expr_data</span>,</span>
<span>  spatial_coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>,</span>
<span>  n_lengthscales <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View top spatially variable genes</span></span>
<span><span class="va">top_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">pval</span><span class="op">)</span>, <span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">top_genes</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ESV"</span>, <span class="st">"pval"</span>, <span class="st">"padj"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpreting-results">Interpreting Results<a class="anchor" aria-label="anchor" href="#interpreting-results"></a>
</h3>
<p><strong>ESV Scores</strong>: - ESV &gt; 0.5: Strong spatial patterns
- ESV 0.2-0.5: Moderate spatial patterns<br>
- ESV &lt; 0.2: Weak spatial patterns</p>
<p><strong>P-values</strong>: Test for statistical significance of
spatial patterns. Use adjusted p-values (padj) for multiple testing
correction.</p>
<p><strong>Variance Components</strong>: - <code>tau.sq</code>:
Non-spatial (nugget) variance - <code>sigma.sq1, sigma.sq2, ...</code>:
Spatial variance at different length scales</p>
</div>
<div class="section level3">
<h3 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h3>
<ul>
<li>See <code><a href="../articles/multiscale-analysis.html">vignette("multiscale-analysis")</a></code> for advanced
multi-scale analysis</li>
<li>See <code><a href="../articles/cell-type-analysis.html">vignette("cell-type-analysis")</a></code> for cell
type-specific workflows</li>
<li>Check function documentation with
<code><a href="../reference/spacelink_global.html">?spacelink_global</a></code>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/xueweic" class="external-link">Your Name</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> and ❤️.</p>
</div>

    </footer>
</div>





  </body>
</html>
