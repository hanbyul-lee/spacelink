[{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"cell-type-specific-analysis","dir":"Articles","previous_headings":"","what":"Cell Type-Specific Analysis","title":"Cell Type-Specific Spatial Analysis","text":"vignette demonstrates analyze spatial patterns specific individual cell types using spacelink package. Cell type-specific analysis helps identify genes whose spatial patterns driven specific cell populations.","code":""},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"when-to-use-cell-type-analysis","dir":"Articles","previous_headings":"Cell Type-Specific Analysis","what":"When to Use Cell Type Analysis","title":"Cell Type-Specific Spatial Analysis","text":"Cell type-specific analysis useful : - cell type proportion/abundance data (e.g., deconvolution methods) - want understand cell types drive spatial gene expression patterns - ’re interested cell type-specific spatial variability beyond global patterns","code":""},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"required-data","dir":"Articles","previous_headings":"Cell Type-Specific Analysis","what":"Required Data","title":"Cell Type-Specific Spatial Analysis","text":"cell type analysis, need: 1. Global analysis results spacelink_global() 2. Cell type data: proportions (e.g., RCTD, SPOTlight) abundance (e.g., Cell2location, stereoscope)","code":"library(spacelink)  # First run global analysis global_results <- spacelink_global(Y, spatial_coords)  # Cell type data should be spots × cell_types matrix # Each row sums to 1 (proportions) or represents abundance dim(cell_type_data)  # n_spots × n_cell_types"},{"path":[]},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"testing-single-cell-types","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Basic Cell Type Analysis","what":"Testing Single Cell Types","title":"Cell Type-Specific Spatial Analysis","text":"Test spatial patterns specific one cell type:","code":"# Test cell type 1 ct1_results <- spacelink_cell_type(   global_test_res = global_results,   ct_idx = 1,                    # Cell type index to test   Y = Y,   spatial_coords = spatial_coords,   cell_type_data = cell_type_data )  # Results contain p-values for cell type-specific spatial patterns head(ct1_results)"},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"testing-all-cell-types","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Basic Cell Type Analysis","what":"Testing All Cell Types","title":"Cell Type-Specific Spatial Analysis","text":"Loop cell types:","code":"n_celltypes <- ncol(cell_type_data) ct_results_list <- list()  for(ct_idx in 1:n_celltypes) {   ct_results_list[[ct_idx]] <- spacelink_cell_type(     global_test_res = global_results,     ct_idx = ct_idx,     Y = Y,     spatial_coords = spatial_coords,     cell_type_data = cell_type_data   ) }  names(ct_results_list) <- colnames(cell_type_data)"},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"cell-type-specific-esv","dir":"Articles","previous_headings":"Cell Type-Specific Analysis","what":"Cell Type-Specific ESV","title":"Cell Type-Specific Spatial Analysis","text":"Calculate ESV scores specific cell type:","code":"# ESV for specific cell type ct1_esv <- spacelink_cell_type_ESV(   global_test_res = global_results,   ct_idx = 1,   Y = Y,   spatial_coords = spatial_coords,   cell_type_data = cell_type_data )  # Results contain cell type-specific ESV scores head(ct1_esv)"},{"path":[]},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"compare-global-vs-cell-type-specific-patterns","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Advanced Analysis","what":"Compare Global vs Cell Type-Specific Patterns","title":"Cell Type-Specific Spatial Analysis","text":"","code":"# Combine results for comparison comparison_data <- data.frame(   gene = rownames(global_results),   global_ESV = global_results$ESV,   global_pval = global_results$pval,   ct1_ESV = ct1_esv$ESV,   ct1_pval = ct1_results$pval )  # Genes with cell type-specific patterns ct_specific <- comparison_data[   comparison_data$ct1_pval < 0.05 &    comparison_data$global_pval > 0.1,  ]  # Genes with global but not cell type-specific patterns   global_only <- comparison_data[   comparison_data$global_pval < 0.05 &    comparison_data$ct1_pval > 0.1, ]  cat(\"Cell type-specific genes:\", nrow(ct_specific), \"\\n\") cat(\"Global-only genes:\", nrow(global_only), \"\\n\")"},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"multi-cell-type-comparison","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Advanced Analysis","what":"Multi-Cell Type Comparison","title":"Cell Type-Specific Spatial Analysis","text":"Compare ESV across multiple cell types:","code":"# Calculate ESV for all cell types esv_matrix <- matrix(0, nrow = nrow(Y), ncol = n_celltypes) colnames(esv_matrix) <- colnames(cell_type_data) rownames(esv_matrix) <- rownames(Y)  for(ct_idx in 1:n_celltypes) {   ct_esv <- spacelink_cell_type_ESV(     global_test_res = global_results,     ct_idx = ct_idx,     Y = Y,     spatial_coords = spatial_coords,     cell_type_data = cell_type_data   )   esv_matrix[, ct_idx] <- ct_esv$ESV }  # Find genes with cell type-specific high ESV max_esv_per_gene <- apply(esv_matrix, 1, max) dominant_celltype <- apply(esv_matrix, 1, which.max)  # Genes with strong cell type specificity specific_genes <- names(which(max_esv_per_gene > 0.4))"},{"path":[]},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"gating-parameters","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Parameter Tuning","what":"Gating Parameters","title":"Cell Type-Specific Spatial Analysis","text":"gating parameters c1 c2 control cell types included null model:","code":"# More stringent gating (fewer confounding cell types) ct_strict <- spacelink_cell_type(   global_test_res = global_results,   ct_idx = 1,   Y = Y,   spatial_coords = spatial_coords,   cell_type_data = cell_type_data,   c1 = 0.5,   # Default: 0.25   c2 = 0.3    # Default: 0.2 )  # More lenient gating (more confounding cell types) ct_lenient <- spacelink_cell_type(   global_test_res = global_results,   ct_idx = 1,   Y = Y,   spatial_coords = spatial_coords,   cell_type_data = cell_type_data,   c1 = 0.1,   c2 = 0.1 )"},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"bandwidth-reduction","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Parameter Tuning","what":"Bandwidth Reduction","title":"Cell Type-Specific Spatial Analysis","text":"Control whether restrict kernel bandwidths:","code":"# Standard analysis (default: restrict bandwidths) ct_standard <- spacelink_cell_type(   global_test_res = global_results,   ct_idx = 1,   Y = Y,   spatial_coords = spatial_coords,   cell_type_data = cell_type_data,   is_phi_reduce = TRUE  # Default )  # Use full bandwidth range ct_full_bandwidth <- spacelink_cell_type(   global_test_res = global_results,   ct_idx = 1,   Y = Y,   spatial_coords = spatial_coords,   cell_type_data = cell_type_data,   is_phi_reduce = FALSE )"},{"path":[]},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"heatmap-of-cell-type-esv","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Visualization","what":"Heatmap of Cell Type ESV","title":"Cell Type-Specific Spatial Analysis","text":"","code":"library(pheatmap)  # Create heatmap of top genes × cell types top_genes <- head(order(global_results$pval), 50) esv_subset <- esv_matrix[top_genes, ]  pheatmap(esv_subset,          cluster_rows = TRUE,          cluster_cols = TRUE,          main = \"Cell Type-Specific ESV\",          color = colorRampPalette(c(\"white\", \"blue\", \"red\"))(100))"},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"compare-esv-distributions","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Visualization","what":"Compare ESV Distributions","title":"Cell Type-Specific Spatial Analysis","text":"","code":"# Box plot of ESV by cell type library(reshape2) library(ggplot2)  esv_long <- melt(esv_matrix[max_esv_per_gene > 0.2, ]) colnames(esv_long) <- c(\"Gene\", \"CellType\", \"ESV\")  ggplot(esv_long, aes(x = CellType, y = ESV)) +   geom_boxplot() +   theme_minimal() +   labs(title = \"ESV Distribution by Cell Type\",        x = \"Cell Type\", y = \"ESV Score\") +   theme(axis.text.x = element_text(angle = 45, hjust = 1))"},{"path":[]},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"esv-score-interpretation","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Interpretation Guidelines","what":"ESV Score Interpretation","title":"Cell Type-Specific Spatial Analysis","text":"ESV > 0.5: Strong cell type-specific spatial patterns ESV 0.2-0.5: Moderate cell type-specific patterns ESV < 0.2: Weak cell type-specific patterns","code":""},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"p-value-interpretation","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Interpretation Guidelines","what":"P-value Interpretation","title":"Cell Type-Specific Spatial Analysis","text":"Significant p-values (< 0.05) indicate spatial patterns specific tested cell type Compare global analysis p-values identify cell type-specific vs global patterns","code":""},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"common-patterns","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Interpretation Guidelines","what":"Common Patterns","title":"Cell Type-Specific Spatial Analysis","text":"Cell type-specific: High cell type ESV, low global ESV Globally spatial: High global ESV, variable cell type ESV Mixed patterns: High ESV multiple cell types","code":""},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"practical-example","dir":"Articles","previous_headings":"Cell Type-Specific Analysis","what":"Practical Example","title":"Cell Type-Specific Spatial Analysis","text":"","code":"# Example workflow with simulated data set.seed(123)  # Simulate cell type data n_spots <- 200 n_celltypes <- 4 cell_type_data <- matrix(runif(n_spots * n_celltypes),                          nrow = n_spots, ncol = n_celltypes) cell_type_data <- cell_type_data / rowSums(cell_type_data)  # Normalize to proportions colnames(cell_type_data) <- paste0(\"CellType_\", 1:n_celltypes)  # Run analysis for first cell type ct1_results <- spacelink_cell_type(   global_test_res = global_results,   ct_idx = 1,   Y = Y,   spatial_coords = spatial_coords,     cell_type_data = cell_type_data )  # Identify cell type-specific spatial genes ct1_specific <- which(ct1_results$pval < 0.05 & global_results$pval > 0.1) cat(\"Found\", length(ct1_specific), \"cell type 1-specific spatial genes\\n\")"},{"path":[]},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"common-issues","dir":"Articles","previous_headings":"Cell Type-Specific Analysis > Troubleshooting","what":"Common Issues","title":"Cell Type-Specific Spatial Analysis","text":"cell_type_data contains binary indicators instead proportions Use global analysis binary cell type indicators covariates instead Try adjusting gating parameters (c1, c2) Check cell type proportions uniform Consider using is_phi_reduce = FALSE Increase n_workers parallelization Reduce number genes use subset testing","code":""},{"path":"https://xueweic.github.io/spacelink/articles/cell-type-analysis.html","id":"next-steps","dir":"Articles","previous_headings":"Cell Type-Specific Analysis","what":"Next Steps","title":"Cell Type-Specific Spatial Analysis","text":"Explore results visualization tools Validate findings known biology Consider functional enrichment analysis cell type-specific spatial genes","code":""},{"path":"https://xueweic.github.io/spacelink/articles/getting-started.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Getting Started with Spacelink","text":"Install development version GitHub:","code":"# install.packages(\"devtools\") devtools::install_github(\"xueweic/spacelink\") library(spacelink)"},{"path":"https://xueweic.github.io/spacelink/articles/getting-started.html","id":"basic-workflow","dir":"Articles","previous_headings":"","what":"Basic Workflow","title":"Getting Started with Spacelink","text":"typical analysis workflow involves two main steps:","code":""},{"path":"https://xueweic.github.io/spacelink/articles/getting-started.html","id":"global-spatial-analysis","dir":"Articles","previous_headings":"Basic Workflow","what":"1. Global Spatial Analysis","title":"Getting Started with Spacelink","text":"Start global analysis identify spatially variable genes: results include: pval : Combined p-value spatial significance padj : Benjamini-Hochberg adjusted p-values ESV : Effective Spatial Variability score (0-1) tau.sq : Nugget variance component sigma.sq1, sigma.sq2, … : Spatial variance components kernel phi1, phi2, … : Inverse gene-specific length scales","code":"# Run global spatial variability analysis global_results <- spacelink_global(   normalized_counts = normalized_expression_matrix,  # Genes × Spots   spatial_coords = coordinates,  # Spots × 2 (x,y coordinates)   n_lengthscales = 5  # Number of spatial bandwidths )  # View results head(global_results[order(global_results$ESV, decreasing=T), ])"},{"path":"https://xueweic.github.io/spacelink/articles/getting-started.html","id":"cell-type-specific-analysis","dir":"Articles","previous_headings":"Basic Workflow","what":"2. Cell-Type-Specific Analysis","title":"Getting Started with Spacelink","text":"cell type proportion information, analyze cell-type-specific spatial patterns: results include: pval : Combined p-value spatial significance ESV : Cell-type-specific Effective Spatial Variability (ct-ESV) score (0-1)","code":"# Cell-type-specific analysis cell_type_results <- spacelink_cell_type(   normalized_counts = normalized_expression_matrix,  # Genes × Spots   spatial_coords = coordinates,  # Spots × 2 (x,y coordinates)   cell_type_proportions = cell_type_proportions,  # Spots × Cell-types   focal_cell_type = cell_type_name,  # Cell type name to test   global_spacelink_results = global_results,  # Not necessary. Providing global results improves efficiency.   calculate_ESV = TRUE )"},{"path":"https://xueweic.github.io/spacelink/articles/getting-started.html","id":"example-with-simulated-data","dir":"Articles","previous_headings":"","what":"Example with Simulated Data","title":"Getting Started with Spacelink","text":"’s example global Spacelink analysis using simulated data:","code":"# Set up simulated data set.seed(123) n_spots <- 200 n_genes <- 100  # Generate spatial coordinates (2D grid) coords <- expand.grid(   x = seq(0, 10, length.out = sqrt(n_spots)),   y = seq(0, 10, length.out = sqrt(n_spots)) )  # Generate expression data with spatial patterns expr_data <- matrix(rnorm(n_genes * n_spots), nrow = n_genes) rownames(expr_data) <- paste0(\"Gene_\", 1:n_genes)  # Add spatial pattern to some genes for(i in 1:10) {   # Create distance-based pattern   center_x <- runif(1, 2, 8)   center_y <- runif(1, 2, 8)   distances <- sqrt((coords$x - center_x)^2 + (coords$y - center_y)^2)   spatial_effect <- exp(-distances/2)   expr_data[i, ] <- expr_data[i, ] + 2 * spatial_effect }  # Run analysis results <- spacelink_global(   normalized_counts = expr_data,   spatial_coords = as.matrix(coords),   n_lengthscales = 5 )  # View top spatially variable genes top_genes <- head(results[order(results$ESV, decreasing=TRUE), ], 10) print(top_genes[, c(\"ESV\", \"pval\", \"padj\")])"},{"path":"https://xueweic.github.io/spacelink/articles/multiscale-analysis.html","id":"application-of-spacelink-to-visium-human-dlpfc-dataset","dir":"Articles","previous_headings":"","what":"Application of Spacelink to Visium Human DLPFC Dataset","title":"Example: Visium Human DLPFC","text":"vignette demonstrates perform spatial gene expression analysis using spacelink package Visium human dorsolateral prefrontal cortex (DLPFC) dataset.","code":""},{"path":"https://xueweic.github.io/spacelink/articles/multiscale-analysis.html","id":"load-packages","dir":"Articles","previous_headings":"Application of Spacelink to Visium Human DLPFC Dataset","what":"Load packages","title":"Example: Visium Human DLPFC","text":"","code":"library(spacelink) library(Seurat) library(sctransform)"},{"path":"https://xueweic.github.io/spacelink/articles/multiscale-analysis.html","id":"load-example-dataset","dir":"Articles","previous_headings":"Application of Spacelink to Visium Human DLPFC Dataset","what":"Load example dataset","title":"Example: Visium Human DLPFC","text":"","code":"data(Visium_human_DLPFC) counts <- Visium_human_DLPFC$counts spatial_coords <- Visium_human_DLPFC$spatial_coords dim(counts) ## [1] 33538  3639 dim(spatial_coords) ## [1] 3639  2"},{"path":"https://xueweic.github.io/spacelink/articles/multiscale-analysis.html","id":"preprocessing","dir":"Articles","previous_headings":"Application of Spacelink to Visium Human DLPFC Dataset","what":"Preprocessing","title":"Example: Visium Human DLPFC","text":"","code":"# Filter mitochondrial and low-expressed genes counts <- counts[!grepl(\"(^MT-)|(^mt-)\", rownames(counts)),] counts <- counts[rowSums(counts >= 3) >= ncol(counts)*0.005,] dim(counts) ## [1] 3309  3639"},{"path":"https://xueweic.github.io/spacelink/articles/multiscale-analysis.html","id":"normalization","dir":"Articles","previous_headings":"Application of Spacelink to Visium Human DLPFC Dataset","what":"Normalization","title":"Example: Visium Human DLPFC","text":"","code":"# Normalize expression counts using sctransform package seurat_obj <- CreateSeuratObject(counts = counts) seurat_norm = SCTransform(seurat_obj, vst.flavor = \"v2\", verbose = FALSE) counts <- seurat_norm@assays$SCT$data"},{"path":"https://xueweic.github.io/spacelink/articles/multiscale-analysis.html","id":"run-global-spacelink","dir":"Articles","previous_headings":"Application of Spacelink to Visium Human DLPFC Dataset","what":"Run global Spacelink","title":"Example: Visium Human DLPFC","text":"","code":"# In this example, the first five genes are used. global_results <- spacelink_global(normalized_counts = counts[1:5,], spatial_coords = spatial_coords)"},{"path":"https://xueweic.github.io/spacelink/articles/multiscale-analysis.html","id":"interpret-results","dir":"Articles","previous_headings":"Application of Spacelink to Visium Human DLPFC Dataset","what":"Interpret results","title":"Example: Visium Human DLPFC","text":"result data frame p-value, ESV, relevant values gene. important columns pval : combined p-values statistical significance spatial patterns. padj : Benjamini-Hochberg adjusted p-values. ESV : Effective Spatial Variability. Spatial pattern stronger ESV closer 1. tau.sq : Non-spatial (nugget) variance. sigma.sq1, sigma.sq2, … : Spatial variance different length scales. phi1, phi2, … : Inverse gene-specific length scales.","code":""},{"path":"https://xueweic.github.io/spacelink/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Name. Author, maintainer.","code":""},{"path":"https://xueweic.github.io/spacelink/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Name Y (2025). spacelink: Multi-Scale Spatial Gene Variability Analysis. R package version 0.1.0, https://xueweic.github.io/spacelink/.","code":"@Manual{,   title = {spacelink: Multi-Scale Spatial Gene Variability Analysis},   author = {Your Name},   year = {2025},   note = {R package version 0.1.0},   url = {https://xueweic.github.io/spacelink/}, }"},{"path":"https://xueweic.github.io/spacelink/index.html","id":"spacelink","dir":"","previous_headings":"","what":"spacelink: Multi-Scale Spatial Gene Variability Analysis","title":"spacelink: Multi-Scale Spatial Gene Variability Analysis","text":"spacelink unified statistical framework detecting prioritizing SVGs global tissue cell-type resolution. Spacelink employs adaptive multi-kernel model capture spatial variance across diverse length scales, cell-type specific version introduces data-driven gating strategy correct spatial colocalization, designed improve specificity cell types weakly represented mixed spots relative abundant colocalizing cell types. summarize spatial variability, define Effective Spatial Variability (ESV), metric integrates variance magnitude component kernel corresponding spatial scale single interpretable score directly suited genetic analyses.","code":""},{"path":"https://xueweic.github.io/spacelink/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"spacelink: Multi-Scale Spatial Gene Variability Analysis","text":"can install development version spacelink GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"xueweic/spacelink\")"},{"path":"https://xueweic.github.io/spacelink/index.html","id":"tutorial","dir":"","previous_headings":"","what":"Tutorial","title":"spacelink: Multi-Scale Spatial Gene Variability Analysis","text":"detailed tutorial available .","code":""},{"path":"https://xueweic.github.io/spacelink/reference/Visium_human_DLPFC.html","id":null,"dir":"Reference","previous_headings":"","what":"Visium human DLPFC data — Visium_human_DLPFC","title":"Visium human DLPFC data — Visium_human_DLPFC","text":"example dataset","code":""},{"path":"https://xueweic.github.io/spacelink/reference/Visium_human_DLPFC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visium human DLPFC data — Visium_human_DLPFC","text":"","code":"Visium_human_DLPFC"},{"path":[]},{"path":"https://xueweic.github.io/spacelink/reference/Visium_human_DLPFC.html","id":"visium-human-dlpfc","dir":"Reference","previous_headings":"","what":"Visium_human_DLPFC","title":"Visium human DLPFC data — Visium_human_DLPFC","text":"list 3 elements counts spatial_coords cell_type_proportions ****","code":""},{"path":"https://xueweic.github.io/spacelink/reference/Visium_human_DLPFC.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Visium human DLPFC data — Visium_human_DLPFC","text":"Visium_human_DLPFC dataset contains","code":""},{"path":"https://xueweic.github.io/spacelink/reference/calculate_ESV.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Effective Spatial Variability — calculate_ESV","title":"Calculate Effective Spatial Variability — calculate_ESV","text":"Calculates Effective Spatial Variability (ESV) score based variance components spatial weights.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/calculate_ESV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Effective Spatial Variability — calculate_ESV","text":"","code":"calculate_ESV(sigma.sq_vec, tau.sq, spatial_coords, phi_seq)"},{"path":"https://xueweic.github.io/spacelink/reference/calculate_ESV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Effective Spatial Variability — calculate_ESV","text":"sigma.sq_vec Vector spatial variance components. tau.sq Nugget variance component. spatial_coords Spatial coordinates matrix. phi_seq Sequence length-scale parameters.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/calculate_ESV.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Effective Spatial Variability — calculate_ESV","text":"Numeric value representing ESV score (0 1).","code":""},{"path":"https://xueweic.github.io/spacelink/reference/run_nnls.html","id":null,"dir":"Reference","previous_headings":"","what":"Non-Negative Least Squares for Spatial Kernels — run_nnls","title":"Non-Negative Least Squares for Spatial Kernels — run_nnls","text":"Performs non-negative least squares fitting spatial kernel regression.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/run_nnls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Non-Negative Least Squares for Spatial Kernels — run_nnls","text":"","code":"run_nnls(   y,   spatial_coords,   phi_seq,   is.sparse = FALSE,   lambda = 0,   is.obj = FALSE )"},{"path":"https://xueweic.github.io/spacelink/reference/run_nnls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Non-Negative Least Squares for Spatial Kernels — run_nnls","text":"y Numeric vector gene expression values. spatial_coords Matrix spatial coordinates. phi_seq Numeric vector length-scale parameters. .sparse Logical indicating whether use sparse regularization. lambda Regularization parameter L1 constraint. .obj Logical indicating whether return objective function value.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/run_nnls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Non-Negative Least Squares for Spatial Kernels — run_nnls","text":"Data frame variance components optional objective value.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/score_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Score Test for Spatial Gene Expression — score_test","title":"Score Test for Spatial Gene Expression — score_test","text":"Performs score tests assess spatial gene expression patterns across multiple length scales.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/score_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Score Test for Spatial Gene Expression — score_test","text":"","code":"score_test(y, spatial_coords, phi_seq)"},{"path":"https://xueweic.github.io/spacelink/reference/score_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Score Test for Spatial Gene Expression — score_test","text":"y Gene expression vector. spatial_coords Spatial coordinates matrix. phi_seq Sequence length-scale parameters.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/score_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Score Test for Spatial Gene Expression — score_test","text":"List containing p-values length scale.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/select_lengthscales.html","id":null,"dir":"Reference","previous_headings":"","what":"Select Optimal Length Scales for Spatial Analysis — select_lengthscales","title":"Select Optimal Length Scales for Spatial Analysis — select_lengthscales","text":"Automatically selects optimal length scales (kernel bandwidths) spatial gene expression analysis using two-step approach based non-negative least squares fitting.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/select_lengthscales.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select Optimal Length Scales for Spatial Analysis — select_lengthscales","text":"","code":"select_lengthscales(   Y,   spatial_coords,   n_lengthscales = 5,   M = 1,   is.inverse = TRUE,   n_workers = 1 )"},{"path":"https://xueweic.github.io/spacelink/reference/select_lengthscales.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select Optimal Length Scales for Spatial Analysis — select_lengthscales","text":"Y Normalized count matrix. Rows columns indicate genes spots, respectively. spatial_coords Spatial coordinates matrix. Rows indicate spots. n_lengthscales Number length-scales (.e., number kernels). Default 5. M Controls minimum length-scale. Minimum length-scale set minimum distance multiplied M. Default 1. .inverse inverse lengthscale (phi) returned? Default TRUE. n_workers Number workers parallelization. Default 1.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/select_lengthscales.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select Optimal Length Scales for Spatial Analysis — select_lengthscales","text":"list containing: phi_mat Matrix selected length scale parameters (phi = 1/lengthscale) gene. row corresponds gene. time Vector computation times gene.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/select_lengthscales.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Select Optimal Length Scales for Spatial Analysis — select_lengthscales","text":"function implements two-step approach selecting optimal length scales: First, fits models across broad range length scales , gene, identifies range variance components non-zero Finally, selects gene-specific length scales within ranges function uses run_nnls internally fit non-negative least squares models gene across different length scales.","code":""},{"path":[]},{"path":"https://xueweic.github.io/spacelink/reference/select_lengthscales.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Select Optimal Length Scales for Spatial Analysis — select_lengthscales","text":"","code":"if (FALSE) { # \\dontrun{ # Generate example data set.seed(123) n_spots <- 100 n_genes <- 20 coords <- matrix(runif(n_spots * 2), ncol = 2) expr_data <- matrix(rnorm(n_genes * n_spots), nrow = n_genes)  # Select optimal length scales length_scales <- select_lengthscales(   Y = expr_data,   spatial_coords = coords,   n_lengthscales = 5 )  # View selected scales for first few genes head(length_scales$phi_mat) } # }"},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_cell_type.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell Type-Specific Spatial Variability Analysis — spacelink_cell_type","title":"Cell Type-Specific Spatial Variability Analysis — spacelink_cell_type","text":"Performs cell type-specific spatial gene variability analysis using results global analysis.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_cell_type.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell Type-Specific Spatial Variability Analysis — spacelink_cell_type","text":"","code":"spacelink_cell_type(   global_test_res,   ct_idx,   Y,   spatial_coords,   cell_type_data,   c1 = 0.25,   c2 = 0.2,   is_phi_reduce = TRUE,   n_workers = 1 )"},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_cell_type.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell Type-Specific Spatial Variability Analysis — spacelink_cell_type","text":"global_test_res Spacelink global SVG test results spacelink_global. ct_idx Index cell-type tested. Y Normalized count matrix. Rows columns indicate genes spots, respectively. spatial_coords Spatial coordinates matrix. Rows indicate spots. cell_type_data Cell-type data matrix. Cell-type proportions (e.g., RCTD) cell-type abundance (e.g., Cell2location). c1 Gating parameter 1. Default 0.25. c2 Gating parameter 2. Default 0.2. is_phi_reduce TRUE, kernel bandwidths restricted smaller maximum distance among cells within target cell type. Default TRUE. n_workers Number workers parallelization. Default 1.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_cell_type.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell Type-Specific Spatial Variability Analysis — spacelink_cell_type","text":"data frame containing: time Computation time pval Combined p-value cell type-specific spatial patterns","code":""},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_cell_type.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cell Type-Specific Spatial Variability Analysis — spacelink_cell_type","text":"","code":"if (FALSE) { # \\dontrun{ # First run global analysis global_results <- spacelink_global(Y, spatial_coords)  # Then cell type-specific analysis ct_results <- spacelink_cell_type(   global_test_res = global_results,   ct_idx = 1,  # first cell type   Y = Y,   spatial_coords = spatial_coords,   cell_type_data = cell_proportions ) } # }"},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_cell_type_ESV.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell Type-Specific Effective Spatial Variability — spacelink_cell_type_ESV","title":"Cell Type-Specific Effective Spatial Variability — spacelink_cell_type_ESV","text":"Calculates Effective Spatial Variability (ESV) scores cell type-specific spatial patterns.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_cell_type_ESV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell Type-Specific Effective Spatial Variability — spacelink_cell_type_ESV","text":"","code":"spacelink_cell_type_ESV(   global_test_res,   ct_idx,   Y,   spatial_coords,   cell_type_data,   c1 = 0.25,   c2 = 0.2,   is_phi_reduce = TRUE,   n_workers = 1 )"},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_cell_type_ESV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell Type-Specific Effective Spatial Variability — spacelink_cell_type_ESV","text":"global_test_res Spacelink global SVG test results spacelink_global. ct_idx Index cell-type tested. Y Normalized count matrix. Rows columns indicate genes spots, respectively. spatial_coords Spatial coordinates matrix. Rows indicate spots. cell_type_data Cell-type data matrix. Cell-type proportions (e.g., RCTD) cell-type abundance (e.g., Cell2location). c1 Gating parameter 1. Default 0.25. c2 Gating parameter 2. Default 0.2. is_phi_reduce TRUE, kernel bandwidths restricted smaller maximum distance among cells within target cell type. Default TRUE. n_workers Number workers parallelization. Default 1.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_cell_type_ESV.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell Type-Specific Effective Spatial Variability — spacelink_cell_type_ESV","text":"data frame containing: time Computation time ESV Effective Spatial Variability score specified cell type","code":""},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_cell_type_ESV.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cell Type-Specific Effective Spatial Variability — spacelink_cell_type_ESV","text":"","code":"if (FALSE) { # \\dontrun{ # Calculate ESV for specific cell type esv_results <- spacelink_cell_type_ESV(   global_test_res = global_results,   ct_idx = 1,   Y = Y,   spatial_coords = spatial_coords,   cell_type_data = cell_proportions ) } # }"},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_global.html","id":null,"dir":"Reference","previous_headings":"","what":"Global Spatial Variability Analysis — spacelink_global","title":"Global Spatial Variability Analysis — spacelink_global","text":"Performs global spatial gene variability analysis across multiple length scales using kernel-based methods.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_global.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Global Spatial Variability Analysis — spacelink_global","text":"","code":"spacelink_global(   Y,   spatial_coords,   X = NULL,   lengthscales = NULL,   n_lengthscales = 5,   M = 1,   n_workers = 1 )"},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_global.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Global Spatial Variability Analysis — spacelink_global","text":"Y Normalized count matrix. Rows columns indicate genes spots, respectively. spatial_coords Spatial coordinates matrix. Rows indicate spots. X Spatial features expected include intercept. NULL, X = rep(1,N) N number spots. lengthscales NULL, length-scales calculated using two-step approach. n_lengthscales Number length-scales (.e., number kernels). Default 5. M Controls minimum length-scale. Minimum length-scale set minimum distance multiplied M. Default 1. n_workers Number workers parallelization. Default 1.","code":""},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_global.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Global Spatial Variability Analysis — spacelink_global","text":"data frame containing: tau.sq Nugget variance component sigma.sq1, sigma.sq2, ... Spatial variance components kernel ESV Effective Spatial Variability score pval Combined p-value score tests padj Benjamini-Hochberg adjusted p-values ESV_adj ESV adjusted multiple testing (0 padj > 0.05)","code":""},{"path":"https://xueweic.github.io/spacelink/reference/spacelink_global.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Global Spatial Variability Analysis — spacelink_global","text":"","code":"if (FALSE) { # \\dontrun{ # Example with simulated data set.seed(123) n_spots <- 100 n_genes <- 50  # Generate spatial coordinates coords <- matrix(runif(n_spots * 2), ncol = 2)  # Generate expression data expr_data <- matrix(rnorm(n_genes * n_spots), nrow = n_genes)  # Run global analysis results <- spacelink_global(   Y = expr_data,   spatial_coords = coords,   n_lengthscales = 5 )  # View top spatially variable genes head(results[order(results$pval), ]) } # }"},{"path":"https://xueweic.github.io/spacelink/news/index.html","id":"spacelink-development-version","dir":"Changelog","previous_headings":"","what":"spacelink (development version)","title":"spacelink (development version)","text":"Initial CRAN submission.","code":""}]
